<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE project>
<project
         xmlns:ivy="antlib:org.apache.ivy.ant">
  
  <target name="init" description="Initialize the necessary directories for build/test processes and release.">
    <!-- Create the time stamp -->
    <tstamp/>
    <!-- Create the build directory structure used by compile -->
    <mkdir dir="${build.dir}"/>
    <mkdir dir="${dist.dir}"/>
    <mkdir dir="${reports.dir}"/>
  </target>
  
  <target name="clean" description="Clean up build, dist, test and report directories." >
    <!-- Delete the ${build.dir} and ${dist} directory trees -->
    <delete dir="${reports.dir}"/>
    <delete dir="${build.dir}"/>
    <delete dir="${dist.dir}"/>
    <!--<delete dir="${classes.dir}"/>
    <delete dir="${javadoc.dir}"/>-->
  </target>


  <property name="ivy.install.version" value="2.1.0-rc2" />
  <condition property="ivy.home" value="${env.IVY_HOME}">
    <isset property="env.IVY_HOME" />
  </condition>
  <property name="ivy.home" location="${dist.lib.dir}/ivy" />
  <property name="ivy.jar.dir" value="${ivy.home}" />
  <property name="ivy.jar.file" value="${ivy.jar.dir}/ivy.jar" />
  <property name="ivy.reports.dir"  location="${reports.dir}/ivy"/>
  <available classname="org.apache.ivy.Main" property="ivy.installed"/>
  
  <!--
  ==================================================
  Ivy setup
  ==================================================
  -->

  <target name="download-ivy" unless="offline" description="Download the ivy jar file.">
    <echo>Downloading ivy.</echo>
    <mkdir dir="${ivy.jar.dir}"/>
    <!-- download Ivy from web site so that it can be used even without any special installation -->
    <get src="https://repo1.maven.org/maven2/org/apache/ivy/ivy/${ivy.install.version}/ivy-${ivy.install.version}.jar" dest="${ivy.jar.file}" usetimestamp="true"/>
  </target>

  <target name="init-ivy" depends="download-ivy" description="Initialize ivy for dependency management">
    <path id="ivy.lib.path">
      <fileset dir="${ivy.jar.dir}" includes="*.jar"/>
    </path>
    <taskdef resource="org/apache/ivy/ant/antlib.xml" uri="antlib:org.apache.ivy.ant" classpathref="ivy.lib.path"/>
  </target>

  <target name="resolve" depends="init-ivy" description="Use ivy to resolve classpaths">
    <echo>Fetching dependencies with ivy.</echo>
    <ivy:retrieve pattern="${lib.dir}/[conf]/[artifact]-[revision].[ext]" conf="test,core,dist"/>
    <mkdir dir="${ivy.reports.dir}"/>
    <ivy:report todir='${ivy.reports.dir}' graph='true' xml='false'/>
    <ivy:cachepath pathid="core.path" conf="core"/>
    <ivy:cachepath pathid="test.path" conf="test"/>
    <ivy:cachepath pathid="dist.path" conf="dist"/>
  </target>

  <!--
  ==================================================
  Groovy setup
  ==================================================
  -->

  <target name="init-groovy" depends="resolve" description="Initialize groovy.">
    <taskdef name="groovyc" classname="org.codehaus.groovy.ant.Groovyc" classpathref="dist.path"/>
  </target>
</project>